{% extends "base.html" %}

{% block og_tags %}
  <meta property="og:title" content="{{ post.meta_title|default:post.title }}">
  <meta property="og:description" content="{{ post.meta_description|default:post.content|truncatewords:20 }}">
  {% if post.featured_image %}
    <meta property="og:image" content="{{ post.featured_image.url }}">
  {% endif %}
  <meta property="og:type" content="article">
  <meta property="og:url" content="{{ request.build_absolute_uri }}">
{% endblock %}

{% block extra_head %}
  <!-- Twitter Card Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ post.meta_title|default:post.title }}">
  <meta name="twitter:description" content="{{ post.meta_description|default:post.content|truncatewords:20 }}">
  {% if post.featured_image %}
    <meta name="twitter:image" content="{{ post.featured_image.url }}">
  {% endif %}

  <!-- JSON-LD Structured Data: BlogPosting -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "{{ post.meta_title|default:post.title|escape }}",
    "description": "{{ post.meta_description|default:post.content|truncatewords:20|escape }}",
    {% if post.featured_image %}
    "image": "{{ post.featured_image.url }}",
    {% endif %}
    "datePublished": "{{ post.created_at|date:'c' }}",
    "author": {
      "@type": "Organization",
      "name": "PolePosition Automation"
    },
    "publisher": {
      "@type": "Organization",
      "name": "PolePosition Automation",
      "logo": {
        "@type": "ImageObject",
        "url": "/static/images/logo.png"
      }
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ request.build_absolute_uri }}"
    }
  }
  </script>

  <!-- JSON-LD Structured Data: BreadcrumbList -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ request.scheme }}://{{ request.get_host }}/"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Blog",
        "item": "{{ request.scheme }}://{{ request.get_host }}{% url 'blog' %}"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "{{ post.title|escape }}",
        "item": "{{ request.build_absolute_uri }}"
      }
    ]
  }
  </script>
{% endblock %}

{% block title %}{{ post.meta_title|default:post.title }} – PolePosition Automation{% endblock %}
{% block description %}{{ post.meta_description|default:post.description|default:post.content|truncatewords:20 }}{% endblock %}

{% block content %}
<section class="py-5">
  <div class="container">

    <!-- Breadcrumbs (visual) -->
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Home</a></li>
        <li class="breadcrumb-item"><a href="{% url 'blog' %}">Blog</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ post.title }}</li>
      </ol>
    </nav>

    <!-- Blog Content -->
    {% if post.featured_image %}
      <picture>
        <source srcset="{{ post.webp_image_url }}" type="image/webp">
        <img src="{{ post.featured_image.url }}"
             width="{{ post.image_width }}"
             height="{{ post.image_height }}"
             alt="{{ post.title }}"
             class="img-fluid mb-3"
             loading="lazy">
      </picture>
    {% endif %}

    {% if post.category %}
      <p class="text-muted mb-1">
        Kategorie: <a href="#">{{ post.category.name }}</a>
      </p>
    {% endif %}

    <h1>{{ post.title }}</h1>
    <p class="text-muted">Veröffentlicht am {{ post.created_at|date:"d. F Y" }}</p>
    <hr>
    <div>
      {{ post.content|linebreaks }}
    </div>
  </div>
</section>
{% endblock %}



